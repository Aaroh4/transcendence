FROM node:23-slim

ARG VITE_STUN_URL
ARG VITE_TURN_URL
ARG VITE_TURN_USER
ARG VITE_TURN_PASS
ARG VITE_EXT_IP

ENV VITE_STUN_URL=$VITE_STUN_URL
ENV VITE_TURN_URL=$VITE_TURN_URL
ENV VITE_TURN_USER=$VITE_TURN_USER
ENV VITE_TURN_PASS=$VITE_TURN_PASS
ENV VITE_EXT_IP=$VITE_EXT_IP

WORKDIR /app

ENV NODE_ENV=development

# For testing
RUN apt-get update && apt-get install -y curl dnsutils

COPY package*.json ./
RUN npm install

COPY . .

EXPOSE 5173

CMD ["npm", "run", "dev"]
